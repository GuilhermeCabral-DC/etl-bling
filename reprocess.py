# %% INICIALIZAÇÃO
from dotenv import load_dotenv
import os
from src.bling_api import BlingAPI
from src.utils import (
    reprocessa_produtos_por_ids,
    reprocessar_todas_falhas,
    reprocessa_saldo_produtos_por_ids,
    reprocessa_pedidos_vendas_por_ids,
    reprocessa_contatos_por_ids
)
from src.log import (
    log_etl
)

from src.config import (
    REPROCESSAR_FULL,
    REPROCESSAR_PRODUTO_MANUAL,
    REPROCESSAR_EMPRESA_MANUAL,
    REPROCESSAR_SALDO_MANUAL,
    REPROCESSAR_PEDIDOS_VENDAS_MANUAL,
    REPROCESSAR_CONTATO_MANUAL
)
   

load_dotenv()
api_key = os.getenv("BLING_API_KEY")
db_uri = os.getenv("POSTGRES_URI")
api = BlingAPI(api_key)


# %% ============= REPROCESSAR FULL =============

if __name__ == "__main__":
    if REPROCESSAR_FULL:
        reprocessar_todas_falhas(api, db_uri)


# %% ============= REPROCESSAR PRODUTO MANUAL =============

if __name__ == "__main__":
    if REPROCESSAR_PRODUTO_MANUAL:
        lista_ids = [
            "14741499438",
            "14839874479"
            
            
        ]
        reprocessa_produtos_por_ids(lista_ids, api, db_uri)
# %% ============= REPROCESSAR SALDO MANUAL =============
if __name__ == "__main__":
    if REPROCESSAR_SALDO_MANUAL:
        lista_ids = [
            "16348508628",
            "16293096921",
            "16091518344",
            "16088511305",
            "8500271185",
            "8500270862",
            "8500270797",
            "8500270783",
            "8500270773",
            "8500270672"                       
        ]
        reprocessa_saldo_produtos_por_ids(lista_ids, api, db_uri)


# %% ============= REPROCESSAR PEDIDOS DE VENDA MANUAL =============
if __name__ == "__main__":
    if REPROCESSAR_PEDIDOS_VENDAS_MANUAL:
        lista_ids = [
            "23793907486",

    
        ]
        reprocessa_pedidos_vendas_por_ids(lista_ids, api, db_uri)
# %% ============= REPROCESSAR CONTATOS =============
if __name__ == "__main__":
    if REPROCESSAR_CONTATO_MANUAL:
        lista_ids = [
            "13817627591",
            "13836690238",
            "14032016557",
            "14691648675",
            "14916741384",
            "14995652384",
            "15073416691",
            "15457469305",
            "15524382710",
            "15663320838",
            "15810349741",
            "15812415883",
            "15824710524",
            "15867125968",
            "15890470662",
            "15973854509",
            "16598589013",
            "16599374760",
            "17636040550",
            "17636048116",
            "17636056948",
            "17636061202",
            "17636078172",
            "17636080173",
            "17636100727",
            "17636116952",
            "17636120816",
            "17636135308",
            "17636140905",
            "17636150337",
            "17636150677",
            "17636163298",
            "17636168988",
            "17636178615",
            "17636192016",
            "17636200701",
            "17636203801",
            "17636208250",
            "17636217164",
            "17636240742",
            "17636246376",
            "17636247193",
            "17636264313",
            "17636269842",
            "17636289007",
            "17636299090",
            "17636338659",
            "17636346095",
            "17636346178",
            "17636348609",
            "17636409873",
            "17636420780",
            "17636430601",
            "17636433396",
            "17636435599",
            "17636442734",
            "17636448503",
            "17636458123",
            "17636459129",
            "17636474629",
            "17636488482",
            "17636496045",
            "17636501770",
            "17636509189",
            "17636512536",
            "17636512852",
            "17636526530",
            "17636549958",
            "17636560545",
            "17636572906",
            "17636578785",
            "17636600327",
            "17636618989",
            "17636622846",
            "17636631268",
            "17636637172",
            "17636640059",
            "17636641300",
            "17636649459",
            "17636653302",
            "17636678375",
            "17636687855",
            "17636688354",
            "17636699209",
            "17636712391",
            "17636716943",
            "17636720907",
            "17636730994",
            "17636731827",
            "17636746022",
            "17636748915",
            "17636758731",
            "17636769617",
            "17636780265",
            "17636791381",
            "17636822365",
            "17636826784",
            "17636827345",
            "17636829491",
            "17636851004",
            "17636858161",
            "17636874355",
            "17636874497",
            "17636876944",
            "17636896466",
            "17636900330",
            "17636907289",
            "17636911836",
            "17636922117",
            "17636925644",
            "17636942733",
            "17636945920",
            "17636953491",
            "17636975009",
            "17636978338",
            "17636987053",
            "17636991604",
            "17636996305",
            "17637008969",
            "17637035101",
            "17637041838",
            "17637053713",
            "17637064116",
            "17637065759",
            "17637082868",
            "17637098904",
            "17637100107",
            "17637105035",
            "17637115183",
            "17637117203",
            "17637117794",
            "17637131419",
            "17637133489",
            "17637145862",
            "17637151377",
            "17637155482",
            "17637155767",
            "17637189226",
            "17637221573",
            "17637227967",
            "17637238976",
            "17637241826",
            "17637243604",
            "17637248122",
            "17637255631",
            "17637256318",
            "17637256647",
            "17637258547",
            "17637279314",
            "17637284161",
            "17637287469",
            "17637287730",
            "17637287887",
            "17637290375",
            "17637295064",
            "17637295576",
            "17637316862",
            "17637319754",
            "17637322955",
            "17637332649",
            "17637335881",
            "17637350375",
            "17637363409",
            "17637367853",
            "17637376452",
            "17637378216",
            "17637380169",
            "17637381863",
            "17637401009",
            "17637404872",
            "17637407999",
            "17637411144",
            "17637418554",
            "17637429050",
            "17637430401",
            "17637444002",
            "17637444705",
            "17637444723",
            "17637446070",
            "17637476330",
            "17637481745",
            "17637487885",
            "17637496353",
            "17637510993",
            "17637514393",
            "17637518717",
            "17637540880",
            "17637544758",
            "17637562685",
            "17637564831",
            "17637588958",
            "17637592036",
            "17637596535",
            "17637602729",
            "17637610504",
            "17637613146",
            "17637614627",
            "17637620854",
            "17637637642",
            "17637643319",
            "17637659028",
            "17637664892",
            "17637673166",
            "17637676319",
            "17637677714",
            "17637679711",
            "17637680096",
            "17637686726",
            "17637690569",
            "17637697174",
            "17637701857",
            "17637704122",
            "17637726528",
            "17637740641",
            "17637746614",
            "17637755726",
            "17637762102",
            "17637769300",
            "17637791198",
            "17637791728",
            "17637810792",
            "17637816648",
            "17637829055",
            "17637831344",
            "17637832463",
            "17637844470",
            "17637855591",
            "17637859494",
            "17637867099",
            "17637878452",
            "17637880815",
            "17637889321",
            "17637901751",
            "17637903848",
            "17637909551",
            "17637917446",
            "17637918919",
            "17637931870",
            "17637935407",
            "17637937462",
            "17637938649",
            "17637946134",
            "17637962565",
            "17637966954",
            "17637971045",
            "17637986395",
            "17638009712",
            "17638016001",
            "17638019409",
            "17638026852",
            "17638035810",
            "17638040905",
            "17638059764",
            "17638064817",
            "17638066430",
            "17638078837",
            "17638079995",
            "17638089498",
            "17638092773",
            "17638101556",
            "17638124226",
            "17638132149",
            "17638140616",
            "17638145545",
            "17638202765",
            "17638238325",
            "17638253504",
            "17638257228",
            "17638292963",
            "17638295244",
            "17638303799",
            "17638316844",
            "17638317981",
            "17638332409",
            "17638339988",
            "17638359341",
            "17638369973",
            "17638379225",
            "17638389323",
            "17638389632",
            "17638406611",
            "17638408279",
            "17638408960",
            "17638413367",
            "17638423102",
            "17638427713",
            "17638432049",
            "17638432829",
            "17638454223",
            "17638476144",
            "17638489071",
            "17638497904",
            "17638515612",
            "17638527990",
            "17638547060",
            "17638552611",
            "17638553608",
            "17638554172",
            "17638557271",
            "17638586361",
            "17638588388",
            "17638588824",
            "17638590112",
            "17638594186",
            "17638594197",
            "17638596041",
            "17638598771",
            "17638605126",
            "17638613051",
            "17638653438",
            "17638659995",
            "17638665053",
            "17638670226",
            "17638689546",
            "17638691247",
            "17638691293",
            "17638708273",
            "17638709941",
            "17638721784",
            "17638753189",
            "17638754679",
            "17638758459",
            "17638767471",
            "17638775181",
            "17638790485",
            "17638790652",
            "17638800995",
            "17638803138",
            "17638805948",
            "17638817832",
            "17638821166",
            "17638826591",
            "17638835653",
            "17638844209",
            "17638845424",
            "17638850074",
            "17638851487",
            "17638859049",
            "17638860285",
            "17638862862",
            "17638879600",
            "17638885110",
            "17638889956",
            "17638891023",
            "17638898360",
            "17638903409",
            "17638903486",
            "17638910704",
            "17638931210",
            "17638959848",
            "17638965187",
            "17638965457",
            "17638974427",
            "17638974989",
            "17638977142",
            "17638984731",
            "17638991509",
            "17639001712",
            "17639003738",
            "17639019451",
            "17639028837",
            "17639049091",
            "17639054908",
            "17639064075",
            "17639067262",
            "17639068401",
            "17639076800",
            "17639081296",
            "17639085636",
            "17639102562",
            "17639104747",
            "17639106567",
            "17639107692",
            "17639112723",
            "17639125694",
            "17639136972",
            "17639137363",
            "17639145652",
            "17639146230",
            "17639156920",
            "17639164415",
            "17639166861",
            "17639174507",
            "17639191352",
            "17639203252",
            "17639208392",
            "17639213970",
            "17639220600",
            "17639221240",
            "17639233928",
            "17639238015",
            "17639259518",
            "17639266185",
            "17639273873",
            "17639295687",
            "17639309070",
            "17639310216",
            "17639314014",
            "17639320283",
            "17639321185",
            "17639334729",
            "17639340636",
            "17639340868",
            "17639343584",
            "17639359815",
            "17639368527",
            "17639373262",
            "17639377229",
            "17639381799",
            "17639396571",
            "17639403211",
            "17639408869",
            "17639409837",
            "17639421581",
            "17639424685",
            "17639430291",
            "17639431955",
            "17639435280",
            "17639441909",
            "17639452344",
            "17639464101",
            "17639509855",
            "17639516154",
            "17639518502",
            "17639523140",
            "17639529023",
            "17639531228",
            "17639537667",
            "17639538460",
            "17639547498",
            "17639565303",
            "17639566171",
            "17639568278",
            "17639580047",
            "17639585959",
            "17639588437",
            "17639601389",
            "17639604947",
            "17639606221",
            "17639608124",
            "17639615005",
            "17639621768",
            "17639624663",
            "17639628622",
            "17639630869",
            "17639634967",
            "17639637817",
            "17639645166",
            "17639651260",
            "17639664843",
            "17639684528",
            "17639697199",
            "17639699481",
            "17639722788",
            "17639729015",
            "17639729508",
            "17639757922",
            "17639760122",
            "17639761519",
            "17639779012",
            "17639791723",
            "17639796981",
            "17639801854",
            "17639804076",
            "17639807917",
            "17639827923",
            "17639840092",
            "17639846104",
            "17639848662",
            "17639864181",
            "17639876142",
            "17639883428",
            "17639884378",
            "17639890147",
            "17639901732",
            "17639902649",
            "17639905220",
            "17639906123",
            "17639908243",
            "17639911443",
            "17639927156",
            "17639928261",
            "17639932813",
            "17639951455",
            "17639958673",
            "17639961021",
            "17639964122",
            "17639975127",
            "17639981380",
            "17639989874",
            "17640008987",
            "17640010088",
            "17640010438",
            "17640015682",
            "17640032707",
            "17640045534",
            "17640050077",
            "17640105786",
            "17640122301",
            "17640125908",
            "17640131513",
            "17640138462",
            "17640140367",
            "17640140793",
            "17640143723",
            "17640160483",
            "17640182434",
            "17640184955",
            "17640192876",
            "17640199203",
            "17640217535",
            "17640219407",
            "17640224564",
            "17640228333",
            "17640236927",
            "17640240897",
            "17640248920",
            "17640251000",
            "17640253507",
            "17640265961",
            "17640274713",
            "17640278239",
            "17640284488",
            "17640307640",
            "17640308558",
            "17640327536",
            "17640330446",
            "17640336503",
            "17640342305",
            "17640347046",
            "17640362383",
            "17640371864",
            "17640375520",
            "17640375730",
            "17640387551",
            "17640389052",
            "17640394065",
            "17640398485",
            "17640404012",
            "17640412315",
            "17640424013",
            "17640428968",
            "17640429614",
            "17640436819",
            "17640441464",
            "17640444642",
            "17640447506",
            "17640474514",
            "17640475310",
            "17640477778",
            "17640478758",
            "17640482776",
            "17640504062",
            "17640524542",
            "17640525036",
            "17640534269",
            "17640542326",
            "17640549778",
            "17640550592",
            "17640551070",
            "17640554384",
            "17641415542"
        ]
        reprocessa_contatos_por_ids(lista_ids, api, db_uri)


# %%
