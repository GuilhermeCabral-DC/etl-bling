# %% INICIALIZAÇÃO
from dotenv import load_dotenv
import os
from src.bling_api import BlingAPI
from src.utils import (
    reprocessa_produtos_por_ids,
    reprocessar_todas_falhas,
    reprocessa_saldo_produtos_por_ids,
    reprocessa_pedidos_vendas_por_ids
)
from src.log import (
    log_etl
)

from src.config import (
    REPROCESSAR_FULL,
    REPROCESSAR_PRODUTO_MANUAL,
    REPROCESSAR_EMPRESA_MANUAL,
    REPROCESSAR_SALDO_MANUAL,
    REPROCESSAR_PEDIDOS_VENDAS_MANUAL
)
   

load_dotenv()
api_key = os.getenv("BLING_API_KEY")
db_uri = os.getenv("POSTGRES_URI")
api = BlingAPI(api_key)


# %% ============= REPROCESSAR FULL =============

if __name__ == "__main__":
    if REPROCESSAR_FULL:
        reprocessar_todas_falhas(api, db_uri)


# %% ============= REPROCESSAR PRODUTO MANUAL =============

if __name__ == "__main__":
    if REPROCESSAR_PRODUTO_MANUAL:
        lista_ids = [
            "16484886977",
            "16484886969",
            "16484886940",
            "16484886890",
            "16484886888",
            "15943425988",
            "15943425975"
            
            
        ]
        reprocessa_produtos_por_ids(lista_ids, api, db_uri)
# %% ============= REPROCESSAR SALDO MANUAL =============
if __name__ == "__main__":
    if REPROCESSAR_SALDO_MANUAL:
        lista_ids = [
            "16348508628",
            "16293096921",
            "16091518344",
            "16088511305",
            "8500271185",
            "8500270862",
            "8500270797",
            "8500270783",
            "8500270773",
            "8500270672"                       
        ]
        reprocessa_saldo_produtos_por_ids(lista_ids, api, db_uri)


# %% ============= REPROCESSAR PEDIDOS DE VENDA MANUAL =============
if __name__ == "__main__":
    if REPROCESSAR_PEDIDOS_VENDAS_MANUAL:
        lista_ids = [
            "20182639895",
            "20167113847",
            "20150835421",
            "20136197389",
            "20135148213",
            "20043346896",
            "20006718002",
            "20006625900",
            "20006620991",
            "20006603007",
            "20006579811",
            "20006509291",
            "20006503571",
            "20006440331",
            "20006285771",
            "20006279283",
            "20006248558",
            "20006241479",
            "20006239280",
            "20005652176",
            "19988806122",
            "19882085548",
            "19834416351",
            "19826644963",
            "19816354432",
            "19810632419",
            "19810620331",
            "19810566224",
            "19809153297",
            "19808711071",
            "19808695402",
            "19808658067",
            "19808610530",
            "19808456231",
            "19808384331",
            "19767449510",
            "19767444560",
            "19767443324",
            "19767246473",
            "19767187699",
            "19767186933",
            "19767156426",
            "19758083929",
            "19757941661",
            "19757930270",
            "19757923080",
            "19755088558",
            "19755059378",
            "19755022547",
            "19754989959",
            "19754983059",
            "19754719734",
            "19754118472",
            "19752764400",
            "19752574641",
            "19751576046",
            "19751346393",
            "19761294086",
            "19749045913",
            "19749033531",
            "19749024580",
            "19748966257",
            "19747892204",
            "19747863711",
            "19747027226",
            "19746929261",
            "19746332868",
            "19745975429",
            "19745852478",
            "19759950484",
            "19747620888",
            "19745794623",
            "19745775210",
            "19745774283",
            "19745761686",
            "19745354918",
            "19745231325",
            "19745211329",
            "19745206178",
            "19745113041",
            "19744491845",
            "19744461600",
            "19744368401",
            "19744269109",
            "19744248573",
            "19744240353",
            "19744173805",
            "19744080828",
            "19744077045",
            "19744015862",
            "19754408409",
            "19744459765",
            "19741373258",
            "19741254137",
            "19740144906",
            "19739794935",
            "19739471764",
            "19737937468",
            "19737450855",
            "19717635287",
            "19717533696",
            "19717470242",
            "19717266050",
            "19715467757",
            "19715381097",
            "19707972145",
            "19540170825",
            "19374989421",
            "19346936627",
            "19215572787",
            "19217131496",
            "19203746513",
            "19106111585",
            "18903145007",
            "18845066481",
            "18663603580",
            "18661039194",
            "18572567541",
            "23714432746",
            "23705894997",
            "23705789148",
            "23705495783",
            "23704750093",
            "23695620303"
    
        ]
        reprocessa_pedidos_vendas_por_ids(lista_ids, api, db_uri)
# %%
